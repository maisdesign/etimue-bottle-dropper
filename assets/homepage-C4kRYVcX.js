let o="it",a=null;function d(e){console.log("ðŸŒ Setting language to:",e),o=e,document.querySelectorAll(".lang .chip").forEach(r=>{const w=r.textContent.trim().toLowerCase()===e.toLowerCase();r.setAttribute("aria-selected",w.toString())});const t=document.getElementById("current-lang");t&&(t.textContent=e==="it"?"ðŸ‡®ðŸ‡¹":"ðŸ‡ºðŸ‡¸"),typeof translatePage=="function"&&translatePage();const i=document.getElementById("click-hint");i&&(i.textContent=e==="it"?"ðŸŽ­ Cambia":"ðŸŽ­ Change");const s=document.querySelector('a[title*="Clicca per cambiare"], a[title*="Click to change"]');s&&(s.title=e==="it"?"ðŸŽ­ Clicca per cambiare personaggio":"ðŸŽ­ Click to change character"),typeof updateAuthStatus=="function"&&updateAuthStatus(),window.gameLanguage&&window.gameLanguage.setLanguage(e)}function u(){d(o==="it"?"en":"it")}function n(e=!1){if(console.log("ðŸ“Š showLeaderboard called, fromProfile:",e),e){typeof closeProfileMenu=="function"&&closeProfileMenu(),window.game&&window.game.scene?window.game.scene.start("LeaderboardScene"):typeof window.startGame=="function"&&(window.startGame(),setTimeout(()=>{var t;(t=window.game)!=null&&t.scene&&window.game.scene.start("LeaderboardScene")},3e3));return}if(window.authManager&&!window.authManager.getState().isAuthenticated){console.log("ðŸ”’ Not authenticated, showing auth modal"),a="showLeaderboard",window.homepageAuthModal?window.homepageAuthModal.show():window.AuthModal?(window.homepageAuthModal=new window.AuthModal,window.homepageAuthModal.onAuth(t=>{console.log("âœ… Authentication successful, executing pending action:",a),typeof updateAuthStatus=="function"&&updateAuthStatus(),a==="startGame"?l():a==="showLeaderboard"&&n(),a=null}),window.homepageAuthModal.show()):alert(o==="it"?"Per visualizzare la classifica devi prima effettuare il login.":"You need to login first to view the leaderboard.");return}console.log("âœ… User authenticated, showing leaderboard"),window.game&&window.game.scene?window.game.scene.start("LeaderboardScene"):typeof window.startGame=="function"&&(window.startGame(),setTimeout(()=>{var t;(t=window.game)!=null&&t.scene&&window.game.scene.start("LeaderboardScene")},3e3))}function c(){n(!0)}function l(){if(console.log("ðŸŽ® startGame called"),window.game&&window.game.scene){console.log("ðŸŽ® Game already running, starting GameScene"),window.game.scene.start("GameScene");return}if(window.authManager&&!window.authManager.getState().isAuthenticated){console.log("ðŸ”’ Not authenticated, showing auth modal"),a="startGame",window.homepageAuthModal?window.homepageAuthModal.show():window.AuthModal?(window.homepageAuthModal=new window.AuthModal,window.homepageAuthModal.onAuth(i=>{console.log("âœ… Authentication successful, executing pending action:",a),typeof updateAuthStatus=="function"&&updateAuthStatus(),a==="startGame"?l():a==="showLeaderboard"&&n(),a=null}),window.homepageAuthModal.show()):alert(o==="it"?"Per giocare devi prima effettuare il login.":"You need to login first to play.");return}console.log("âœ… User authenticated, starting game");const e=document.getElementById("homepage"),t=document.getElementById("game-container");e&&(e.style.display="none"),t&&(t.style.display="block"),!window.game&&typeof window.initializeGame=="function"?window.initializeGame():window.game||console.log("âš ï¸ Game initialization not available (production mode)")}window.setLanguage=d;window.toggleLanguage=u;window.showLeaderboard=n;window.showLeaderboardFromProfile=c;window.startGame=l;document.addEventListener("DOMContentLoaded",()=>{var t;console.log("ðŸ“± Homepage JavaScript initialized");const e=localStorage.getItem("language")||((t=navigator.language)!=null&&t.startsWith("it")?"it":"en");d(e)});
